2025-04-30 11:13:47,857 - segment_embeddings - INFO - Starting segment_gemini_outputs.py
2025-04-30 11:13:47,857 - segment_embeddings - INFO - Arguments: image=data/mjolnir_gt.jpeg, output=segmentation_results
2025-04-30 11:13:47,858 - segment_embeddings - INFO - Created output directories in segmentation_results
2025-04-30 11:13:47,858 - segment_embeddings - INFO - Building SAM2 model...
2025-04-30 11:13:47,858 - segment_embeddings - INFO - Starting path: /Users/andrewdelacruz/e2e_sam2
2025-04-30 11:13:47,901 - segment_embeddings - INFO - Using MPS (Apple Silicon). Note that SAM2 might give different outputs on MPS.
2025-04-30 11:13:47,901 - segment_embeddings - INFO - Selected device: mps
2025-04-30 11:13:49,391 - segment_embeddings - INFO - SAM2 model built successfully in 1.53 seconds
2025-04-30 11:13:49,391 - segment_embeddings - INFO - Creating automatic mask generator...
2025-04-30 11:13:49,524 - segment_embeddings - INFO - Initializing embedding generator...
2025-04-30 11:13:49,524 - segment_embeddings - INFO - Using MPS (Apple Silicon). Note that SAM2 might give different outputs on MPS.
2025-04-30 11:13:49,524 - segment_embeddings - INFO - Selected device: mps
2025-04-30 11:13:51,208 - segment_embeddings - INFO - Loading image from data/mjolnir_gt.jpeg
2025-04-30 11:13:51,213 - segment_embeddings - INFO - Image loaded successfully: (316, 160, 3)
2025-04-30 11:13:51,215 - segment_embeddings - INFO - Generating masks...
2025-04-30 11:13:51,215 - root - INFO - For numpy array image, we assume (HxWxC) format
2025-04-30 11:13:51,276 - root - INFO - Computing image embeddings for the provided image...
2025-04-30 11:13:57,787 - root - INFO - Image embeddings computed.
2025-04-30 11:15:31,535 - segment_embeddings - INFO - Starting segment_gemini_outputs.py
2025-04-30 11:15:31,536 - segment_embeddings - INFO - Arguments: image=data/mjolnir_gt.jpeg, output=segmentation_results
2025-04-30 11:15:31,536 - segment_embeddings - INFO - Created output directories in segmentation_results
2025-04-30 11:15:31,536 - segment_embeddings - INFO - Building SAM2 model...
2025-04-30 11:15:31,536 - segment_embeddings - INFO - Starting path: /Users/andrewdelacruz/e2e_sam2
2025-04-30 11:15:31,559 - segment_embeddings - INFO - Using MPS (Apple Silicon). Note that SAM2 might give different outputs on MPS.
2025-04-30 11:15:31,559 - segment_embeddings - INFO - Selected device: mps
2025-04-30 11:15:32,960 - segment_embeddings - INFO - SAM2 model built successfully in 1.42 seconds
2025-04-30 11:15:32,961 - segment_embeddings - INFO - Creating automatic mask generator...
2025-04-30 11:15:33,071 - segment_embeddings - INFO - Initializing embedding generator...
2025-04-30 11:15:33,072 - segment_embeddings - INFO - Using MPS (Apple Silicon). Note that SAM2 might give different outputs on MPS.
2025-04-30 11:15:33,072 - segment_embeddings - INFO - Selected device: mps
2025-04-30 11:15:34,830 - segment_embeddings - INFO - Loading image from data/mjolnir_gt.jpeg
2025-04-30 11:15:34,837 - segment_embeddings - INFO - Image loaded successfully: (316, 160, 3)
2025-04-30 11:15:34,838 - segment_embeddings - INFO - Generating masks...
2025-04-30 11:15:34,839 - root - INFO - For numpy array image, we assume (HxWxC) format
2025-04-30 11:15:34,900 - root - INFO - Computing image embeddings for the provided image...
2025-04-30 11:15:41,803 - root - INFO - Image embeddings computed.
2025-04-30 11:19:43,160 - segment_embeddings - INFO - Starting segment_gemini_outputs.py
2025-04-30 11:19:43,161 - segment_embeddings - INFO - Arguments: image=data/mjolnir_gt.jpeg, output=segmentation_results, max_segments=None, models=both
2025-04-30 11:19:43,161 - segment_embeddings - INFO - Created output directories in segmentation_results
2025-04-30 11:19:43,161 - segment_embeddings - INFO - Building SAM2 model...
2025-04-30 11:19:43,161 - segment_embeddings - INFO - Starting path: /Users/andrewdelacruz/e2e_sam2
2025-04-30 11:19:43,185 - segment_embeddings - INFO - Using MPS (Apple Silicon). Note that SAM2 might give different outputs on MPS.
2025-04-30 11:19:43,185 - segment_embeddings - INFO - Selected device: mps
2025-04-30 11:19:44,614 - segment_embeddings - INFO - SAM2 model built successfully in 1.45 seconds
2025-04-30 11:19:44,614 - segment_embeddings - INFO - Creating automatic mask generator...
2025-04-30 11:19:44,756 - segment_embeddings - INFO - Initializing embedding generator with models: ['vit', 'resnet50']
2025-04-30 11:19:44,756 - segment_embeddings - INFO - Using MPS (Apple Silicon). Note that SAM2 might give different outputs on MPS.
2025-04-30 11:19:44,756 - segment_embeddings - INFO - Selected device: mps
2025-04-30 11:19:46,391 - segment_embeddings - INFO - Loading image from data/mjolnir_gt.jpeg
2025-04-30 11:19:46,401 - segment_embeddings - INFO - Image loaded successfully: (316, 160, 3)
2025-04-30 11:19:46,403 - segment_embeddings - INFO - Generating masks...
2025-04-30 11:19:46,403 - root - INFO - For numpy array image, we assume (HxWxC) format
2025-04-30 11:19:46,465 - root - INFO - Computing image embeddings for the provided image...
2025-04-30 11:19:51,426 - root - INFO - Image embeddings computed.
2025-04-30 11:23:42,436 - segment_embeddings - INFO - Starting segment_gemini_outputs.py
2025-04-30 11:23:42,437 - segment_embeddings - INFO - Arguments: image=data/mjolnir_gt.jpeg, output=segmentation_results, max_segments=None, models=both
2025-04-30 11:23:42,437 - segment_embeddings - INFO - Created output directories in segmentation_results
2025-04-30 11:23:42,437 - segment_embeddings - INFO - Building SAM2 model...
2025-04-30 11:23:42,437 - segment_embeddings - INFO - Starting path: /Users/andrewdelacruz/e2e_sam2
2025-04-30 11:23:42,460 - segment_embeddings - INFO - Using MPS (Apple Silicon). Note that SAM2 might give different outputs on MPS.
2025-04-30 11:23:42,460 - segment_embeddings - INFO - Selected device: mps
2025-04-30 11:23:43,922 - segment_embeddings - INFO - SAM2 model built successfully in 1.48 seconds
2025-04-30 11:23:43,922 - segment_embeddings - INFO - Creating automatic mask generator...
2025-04-30 11:23:44,034 - segment_embeddings - INFO - Initializing embedding generator with models: ['vit', 'resnet50']
2025-04-30 11:23:44,035 - segment_embeddings - INFO - Using MPS (Apple Silicon). Note that SAM2 might give different outputs on MPS.
2025-04-30 11:23:44,035 - segment_embeddings - INFO - Selected device: mps
2025-04-30 11:23:45,810 - segment_embeddings - INFO - Loading image from data/mjolnir_gt.jpeg
2025-04-30 11:23:45,816 - segment_embeddings - INFO - Image loaded successfully: (316, 160, 3)
2025-04-30 11:23:45,818 - segment_embeddings - INFO - Generating masks...
2025-04-30 11:23:45,818 - root - INFO - For numpy array image, we assume (HxWxC) format
2025-04-30 11:23:45,882 - root - INFO - Computing image embeddings for the provided image...
2025-04-30 11:23:52,783 - root - INFO - Image embeddings computed.
2025-04-30 11:25:32,061 - segment_embeddings - INFO - Starting segment_gemini_outputs.py
2025-04-30 11:25:32,061 - segment_embeddings - INFO - Arguments: image=data/mjolnir_gt.jpeg, output=segmentation_results, max_segments=None, models=both
2025-04-30 11:25:32,061 - segment_embeddings - INFO - Created output directories in segmentation_results
2025-04-30 11:25:32,061 - segment_embeddings - INFO - Building SAM2 model...
2025-04-30 11:25:32,062 - segment_embeddings - INFO - Starting path: /Users/andrewdelacruz/e2e_sam2
2025-04-30 11:25:32,139 - segment_embeddings - INFO - Using MPS (Apple Silicon). Note that SAM2 might give different outputs on MPS.
2025-04-30 11:25:32,139 - segment_embeddings - INFO - Selected device: mps
2025-04-30 11:25:35,608 - segment_embeddings - INFO - SAM2 model built successfully in 3.54 seconds
2025-04-30 11:25:35,615 - segment_embeddings - INFO - Creating automatic mask generator...
2025-04-30 11:25:36,092 - segment_embeddings - INFO - Initializing embedding generator with models: ['vit', 'resnet50']
2025-04-30 11:25:36,097 - segment_embeddings - INFO - Using MPS (Apple Silicon). Note that SAM2 might give different outputs on MPS.
2025-04-30 11:25:36,097 - segment_embeddings - INFO - Selected device: mps
2025-04-30 11:25:44,753 - segment_embeddings - INFO - Loading image from data/mjolnir_gt.jpeg
2025-04-30 11:25:44,860 - segment_embeddings - INFO - Image loaded successfully: (316, 160, 3)
2025-04-30 11:25:44,893 - segment_embeddings - INFO - Generating masks...
2025-04-30 11:25:44,905 - root - INFO - For numpy array image, we assume (HxWxC) format
2025-04-30 11:25:45,145 - root - INFO - Computing image embeddings for the provided image...
2025-04-30 18:33:06,417 - segment_embeddings - INFO - Starting segment_gemini_outputs.py
2025-04-30 18:33:06,418 - segment_embeddings - INFO - Arguments: image=data/mjolnir_gt.jpeg, output=segmentation_results, max_segments=None, models=both
2025-04-30 18:33:06,419 - segment_embeddings - INFO - Created output directories in segmentation_results
2025-04-30 18:33:06,419 - segment_embeddings - INFO - Building SAM2 model...
2025-04-30 18:33:06,419 - segment_embeddings - INFO - Starting path: /home/ubuntu/code/drew/e2e_sam2
2025-04-30 18:33:06,591 - segment_embeddings - INFO - Using CUDA GPU for computation
2025-04-30 18:33:06,592 - segment_embeddings - INFO - Selected device: cuda
2025-04-30 18:33:09,168 - segment_embeddings - INFO - SAM2 model built successfully in 2.75 seconds
2025-04-30 18:33:09,168 - segment_embeddings - INFO - Creating automatic mask generator...
2025-04-30 18:33:09,306 - segment_embeddings - INFO - Initializing embedding generator with models: ['vit', 'resnet50']
2025-04-30 18:33:09,306 - segment_embeddings - INFO - Using CUDA GPU for computation
2025-04-30 18:33:09,306 - segment_embeddings - INFO - Selected device: cuda
2025-04-30 18:33:09,851 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-30 18:33:12,119 - segment_embeddings - INFO - Loading image from data/mjolnir_gt.jpeg
2025-04-30 18:33:12,119 - segment_embeddings - INFO - Image loaded successfully: (316, 160, 3)
2025-04-30 18:33:12,120 - segment_embeddings - INFO - Generating masks...
2025-04-30 18:33:12,120 - root - INFO - For numpy array image, we assume (HxWxC) format
2025-04-30 18:33:12,198 - root - INFO - Computing image embeddings for the provided image...
2025-04-30 18:33:12,959 - root - INFO - Image embeddings computed.
2025-04-30 18:33:16,592 - root - INFO - For numpy array image, we assume (HxWxC) format
2025-04-30 18:33:16,617 - root - INFO - Computing image embeddings for the provided image...
2025-04-30 18:33:16,639 - root - INFO - Image embeddings computed.
2025-04-30 18:33:18,049 - root - INFO - For numpy array image, we assume (HxWxC) format
2025-04-30 18:33:18,055 - root - INFO - Computing image embeddings for the provided image...
2025-04-30 18:33:18,077 - root - INFO - Image embeddings computed.
2025-04-30 18:33:19,484 - root - INFO - For numpy array image, we assume (HxWxC) format
2025-04-30 18:33:19,490 - root - INFO - Computing image embeddings for the provided image...
2025-04-30 18:33:19,512 - root - INFO - Image embeddings computed.
2025-04-30 18:33:20,919 - root - INFO - For numpy array image, we assume (HxWxC) format
2025-04-30 18:33:20,925 - root - INFO - Computing image embeddings for the provided image...
2025-04-30 18:33:20,947 - root - INFO - Image embeddings computed.
2025-04-30 18:33:22,358 - segment_embeddings - ERROR - Error: too many indices for tensor of dimension 1
Traceback (most recent call last):
  File "/home/ubuntu/code/drew/e2e_sam2/e2e_pipeline_v2/experiments/segment_gemini_outputs.py", line 405, in <module>
    results = modified_process_image()
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/code/drew/e2e_sam2/e2e_pipeline_v2/experiments/segment_gemini_outputs.py", line 264, in modified_process_image
    masks = mask_generator.generate(image)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/code/drew/e2e_sam2/venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/code/drew/sam2/sam2/automatic_mask_generator.py", line 196, in generate
    mask_data = self._generate_masks(image)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/code/drew/sam2/sam2/automatic_mask_generator.py", line 239, in _generate_masks
    scores = 1 / box_area(data["crop_boxes"])
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/code/drew/e2e_sam2/venv/lib/python3.12/site-packages/torchvision/ops/boxes.py", line 251, in box_area
    return (boxes[:, 2] - boxes[:, 0]) * (boxes[:, 3] - boxes[:, 1])
            ~~~~~^^^^^^
IndexError: too many indices for tensor of dimension 1
2025-04-30 11:44:30,753 - segment_embeddings - INFO - Starting segment_gemini_outputs.py
2025-04-30 11:44:30,754 - segment_embeddings - INFO - Arguments: image=data/mjolnir_gt.jpeg, output=segmentation_results, max_segments=2, models=both
2025-04-30 11:44:30,754 - segment_embeddings - INFO - Created output directories in segmentation_results
2025-04-30 11:44:30,754 - segment_embeddings - INFO - Building SAM2 model...
2025-04-30 11:44:30,754 - segment_embeddings - INFO - Starting path: /Users/andrewdelacruz/e2e_sam2
2025-04-30 11:44:30,782 - segment_embeddings - INFO - Using MPS (Apple Silicon). Note that SAM2 might give different outputs on MPS.
2025-04-30 11:44:30,782 - segment_embeddings - INFO - Selected device: mps
2025-04-30 11:44:30,782 - segment_embeddings - DEBUG - Loading SAM2 model configuration from config file
2025-04-30 11:44:30,782 - segment_embeddings - DEBUG - Building SAM2 model with config: configs/sam2.1/sam2.1_hiera_l.yaml, checkpoint: checkpoints/sam2.1_hiera_large.pt, device: mps
2025-04-30 11:44:32,261 - segment_embeddings - DEBUG - SAM2 model built successfully
2025-04-30 11:44:32,261 - segment_embeddings - INFO - Using MPS (Apple Silicon). Note that SAM2 might give different outputs on MPS.
2025-04-30 11:44:32,261 - segment_embeddings - INFO - Selected device: mps
2025-04-30 11:44:32,377 - segment_embeddings - INFO - SAM2 model built successfully in 1.62 seconds
2025-04-30 11:44:32,377 - segment_embeddings - DEBUG - SAM2 model type: <class 'sam2.modeling.sam2_base.SAM2Base'>
2025-04-30 11:44:32,377 - segment_embeddings - INFO - Using MPS (Apple Silicon). Note that SAM2 might give different outputs on MPS.
2025-04-30 11:44:32,377 - segment_embeddings - INFO - Selected device: mps
2025-04-30 11:44:32,377 - segment_embeddings - INFO - Creating automatic mask generator for mps...
2025-04-30 11:44:32,377 - segment_embeddings - INFO - Using mps-specific settings for mask generator
2025-04-30 11:44:32,377 - segment_embeddings - DEBUG - Parameters: points_per_side=32, pred_iou_thresh=0.86, stability_score_thresh=0.92
2025-04-30 11:44:32,537 - segment_embeddings - DEBUG - Mask generator created successfully: <class 'sam2.automatic_mask_generator.SAM2AutomaticMaskGenerator'>
2025-04-30 11:44:32,537 - segment_embeddings - INFO - Skipping embedding generator initialization as requested
2025-04-30 11:44:32,537 - segment_embeddings - INFO - Loading image from data/mjolnir_gt.jpeg
2025-04-30 11:44:32,566 - segment_embeddings - DEBUG - Image file size: 5.97 KB
2025-04-30 11:44:32,566 - segment_embeddings - INFO - Image loaded successfully: (316, 160, 3), dtype: uint8
2025-04-30 11:44:32,566 - segment_embeddings - DEBUG - Converting image from BGR to RGB
2025-04-30 11:44:32,570 - segment_embeddings - DEBUG - Image pixel range - Min: 0, Max: 255, Mean: 215.79
2025-04-30 11:44:32,570 - segment_embeddings - INFO - Generating masks...
2025-04-30 11:44:32,570 - segment_embeddings - INFO - Generating masks on mps device...
2025-04-30 11:44:32,570 - segment_embeddings - DEBUG - Image type: <class 'numpy.ndarray'>, Shape: (316, 160, 3), dtype: uint8
2025-04-30 11:44:32,570 - segment_embeddings - DEBUG - Image is numpy array, Min: 0, Max: 255, Mean: 215.79
2025-04-30 11:44:32,570 - segment_embeddings - DEBUG - Attempting standard mask generation approach
2025-04-30 11:44:32,570 - root - INFO - For numpy array image, we assume (HxWxC) format
2025-04-30 11:44:32,626 - root - INFO - Computing image embeddings for the provided image...
2025-04-30 11:44:36,534 - root - INFO - Image embeddings computed.
