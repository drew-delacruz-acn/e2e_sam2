2025-04-18 14:58:39,621 - INFO - Logging initialized. Log file: ./comparison_results/logs/comparison_20250418_145839.log
2025-04-18 14:58:39,622 - INFO - Python version: 3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:56:27) [GCC 11.2.0]
2025-04-18 14:58:39,622 - INFO - PyTorch version: 2.6.0+cu124
2025-04-18 14:58:39,622 - INFO - OpenCV version: 4.11.0
2025-04-18 14:58:39,622 - INFO - Arguments: {'data_dir': '../data/davis-2017/DAVIS/', 'splits_dir': './dataset_splits', 'pretrained_checkpoint': '../checkpoints/sam2.1_hiera_large.pt', 'finetuned_checkpoint': './model_best.torch', 'model_cfg': '../configs/sam2.1/sam2.1_hiera_l.yaml', 'output_dir': './comparison_results', 'num_samples': -1, 'debug': False}
2025-04-18 14:58:39,663 - INFO - Using CUDA device: Tesla V100-SXM2-16GB
2025-04-18 14:58:39,663 - INFO - CUDA memory allocated: 0.00 GB
2025-04-18 14:58:39,663 - INFO - Loaded 17 samples from ./dataset_splits/val.json
2025-04-18 14:58:39,664 - INFO - 
Evaluating pre-trained model...
2025-04-18 14:58:39,664 - INFO - Loading model from ../checkpoints/sam2.1_hiera_large.pt
2025-04-18 14:58:43,065 - INFO - Loaded checkpoint sucessfully
2025-04-18 14:58:43,526 - INFO - Model loaded successfully
2025-04-18 14:58:43,555 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:43,659 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:43,974 - INFO - Image embeddings computed.
2025-04-18 14:58:44,077 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:44,113 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:44,149 - INFO - Image embeddings computed.
2025-04-18 14:58:44,331 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:44,340 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:44,376 - INFO - Image embeddings computed.
2025-04-18 14:58:44,558 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:44,567 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:44,603 - INFO - Image embeddings computed.
2025-04-18 14:58:44,785 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:44,794 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:44,830 - INFO - Image embeddings computed.
2025-04-18 14:58:45,011 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:45,022 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:45,059 - INFO - Image embeddings computed.
2025-04-18 14:58:45,240 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:45,249 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:45,285 - INFO - Image embeddings computed.
2025-04-18 14:58:45,466 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:45,475 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:45,511 - INFO - Image embeddings computed.
2025-04-18 14:58:45,693 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:45,702 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:45,738 - INFO - Image embeddings computed.
2025-04-18 14:58:45,920 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:45,930 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:45,967 - INFO - Image embeddings computed.
2025-04-18 14:58:46,148 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:46,157 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:46,193 - INFO - Image embeddings computed.
2025-04-18 14:58:46,375 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:46,384 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:46,421 - INFO - Image embeddings computed.
2025-04-18 14:58:46,601 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:46,610 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:46,647 - INFO - Image embeddings computed.
2025-04-18 14:58:46,828 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:46,837 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:46,874 - INFO - Image embeddings computed.
2025-04-18 14:58:47,054 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:47,064 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:47,100 - INFO - Image embeddings computed.
2025-04-18 14:58:47,281 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:47,290 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:47,327 - INFO - Image embeddings computed.
2025-04-18 14:58:47,508 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 14:58:47,517 - INFO - Computing image embeddings for the provided image...
2025-04-18 14:58:47,553 - INFO - Image embeddings computed.
2025-04-18 14:58:47,711 - INFO - Evaluation completed. Processed 17 samples successfully.
2025-04-18 14:58:47,711 - INFO - 
Evaluating fine-tuned model...
2025-04-18 14:58:47,711 - INFO - Loading model from ./model_best.torch
2025-04-18 14:58:50,816 - ERROR - Error loading model: 'model'
2025-04-18 14:58:50,816 - ERROR - Traceback (most recent call last):
  File "/home/ubuntu/code/drew/experiments/e2e_sam2/train_sam2/compare_models.py", line 99, in load_model
    model = build_sam2(model_cfg, checkpoint_path, device=device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/code/drew/sam2/sam2/build_sam.py", line 93, in build_sam2
    _load_checkpoint(model, ckpt_path)
  File "/home/ubuntu/code/drew/sam2/sam2/build_sam.py", line 166, in _load_checkpoint
    sd = torch.load(ckpt_path, map_location="cpu", weights_only=True)["model"]
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyError: 'model'

2025-04-18 14:58:50,817 - ERROR - Fatal error in main execution:
2025-04-18 14:58:50,817 - ERROR - 'model'
2025-04-18 14:58:50,817 - ERROR - Traceback (most recent call last):
  File "/home/ubuntu/code/drew/experiments/e2e_sam2/train_sam2/compare_models.py", line 317, in main
    finetuned_predictor = load_model(args.finetuned_checkpoint, args.model_cfg, device)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/code/drew/experiments/e2e_sam2/train_sam2/compare_models.py", line 99, in load_model
    model = build_sam2(model_cfg, checkpoint_path, device=device)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/code/drew/sam2/sam2/build_sam.py", line 93, in build_sam2
    _load_checkpoint(model, ckpt_path)
  File "/home/ubuntu/code/drew/sam2/sam2/build_sam.py", line 166, in _load_checkpoint
    sd = torch.load(ckpt_path, map_location="cpu", weights_only=True)["model"]
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyError: 'model'

