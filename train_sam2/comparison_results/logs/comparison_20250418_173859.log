2025-04-18 17:38:59,767 - INFO - Logging initialized. Log file: ./comparison_results/logs/comparison_20250418_173859.log
2025-04-18 17:38:59,767 - INFO - Python version: 3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:56:27) [GCC 11.2.0]
2025-04-18 17:38:59,767 - INFO - PyTorch version: 2.6.0+cu124
2025-04-18 17:38:59,767 - INFO - OpenCV version: 4.11.0
2025-04-18 17:38:59,768 - INFO - Arguments: {'data_dir': '../data/davis-2017/DAVIS/', 'splits_dir': './dataset_splits', 'pretrained_checkpoint': '../checkpoints/sam2.1_hiera_large.pt', 'finetuned_checkpoint': './model.torch', 'model_cfg': '../configs/sam2.1/sam2.1_hiera_l.yaml', 'output_dir': './comparison_results', 'num_samples': -1, 'debug': False}
2025-04-18 17:38:59,811 - INFO - Using CUDA device: Tesla V100-SXM2-16GB
2025-04-18 17:38:59,812 - INFO - CUDA memory allocated: 0.00 GB
2025-04-18 17:38:59,812 - INFO - Loaded 17 samples from ./dataset_splits/val.json
2025-04-18 17:38:59,812 - INFO - 
Evaluating pre-trained model...
2025-04-18 17:38:59,813 - INFO - Loading model from ../checkpoints/sam2.1_hiera_large.pt
2025-04-18 17:38:59,813 - INFO - Loading as state dict: ../checkpoints/sam2.1_hiera_large.pt
2025-04-18 17:39:03,450 - INFO - Model loaded successfully
2025-04-18 17:39:03,480 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:03,584 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:03,914 - INFO - Image embeddings computed.
2025-04-18 17:39:04,107 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:04,138 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:04,177 - INFO - Image embeddings computed.
2025-04-18 17:39:04,357 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:04,367 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:04,405 - INFO - Image embeddings computed.
2025-04-18 17:39:04,585 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:04,594 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:04,639 - INFO - Image embeddings computed.
2025-04-18 17:39:04,812 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:04,821 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:04,859 - INFO - Image embeddings computed.
2025-04-18 17:39:05,039 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:05,048 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:05,086 - INFO - Image embeddings computed.
2025-04-18 17:39:05,267 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:05,276 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:05,314 - INFO - Image embeddings computed.
2025-04-18 17:39:05,494 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:05,504 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:05,541 - INFO - Image embeddings computed.
2025-04-18 17:39:05,721 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:05,731 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:05,771 - INFO - Image embeddings computed.
2025-04-18 17:39:05,949 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:05,958 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:05,996 - INFO - Image embeddings computed.
2025-04-18 17:39:06,176 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:06,186 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:06,223 - INFO - Image embeddings computed.
2025-04-18 17:39:06,404 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:06,415 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:06,452 - INFO - Image embeddings computed.
2025-04-18 17:39:06,636 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:06,648 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:06,685 - INFO - Image embeddings computed.
2025-04-18 17:39:06,866 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:06,875 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:06,913 - INFO - Image embeddings computed.
2025-04-18 17:39:07,092 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:07,103 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:07,141 - INFO - Image embeddings computed.
2025-04-18 17:39:07,321 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:07,331 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:07,368 - INFO - Image embeddings computed.
2025-04-18 17:39:07,548 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:07,558 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:07,595 - INFO - Image embeddings computed.
2025-04-18 17:39:07,757 - INFO - Evaluation completed. Processed 17 samples successfully.
2025-04-18 17:39:07,757 - INFO - 
Evaluating fine-tuned model...
2025-04-18 17:39:07,757 - INFO - Loading model from ./model.torch
2025-04-18 17:39:07,757 - INFO - Loading as state dict: ./model.torch
2025-04-18 17:39:10,940 - INFO - Model loaded successfully
2025-04-18 17:39:10,966 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:10,975 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:11,013 - INFO - Image embeddings computed.
2025-04-18 17:39:11,193 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:11,202 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:11,239 - INFO - Image embeddings computed.
2025-04-18 17:39:11,420 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:11,430 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:11,466 - INFO - Image embeddings computed.
2025-04-18 17:39:11,647 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:11,656 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:11,693 - INFO - Image embeddings computed.
2025-04-18 17:39:11,874 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:11,884 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:11,921 - INFO - Image embeddings computed.
2025-04-18 17:39:12,102 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:12,111 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:12,148 - INFO - Image embeddings computed.
2025-04-18 17:39:12,329 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:12,338 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:12,375 - INFO - Image embeddings computed.
2025-04-18 17:39:12,556 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:12,565 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:12,602 - INFO - Image embeddings computed.
2025-04-18 17:39:12,783 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:12,792 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:12,829 - INFO - Image embeddings computed.
2025-04-18 17:39:13,010 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:13,019 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:13,056 - INFO - Image embeddings computed.
2025-04-18 17:39:13,237 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:13,246 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:13,283 - INFO - Image embeddings computed.
2025-04-18 17:39:13,464 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:13,473 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:13,510 - INFO - Image embeddings computed.
2025-04-18 17:39:13,691 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:13,700 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:13,737 - INFO - Image embeddings computed.
2025-04-18 17:39:13,918 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:13,927 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:13,965 - INFO - Image embeddings computed.
2025-04-18 17:39:14,145 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:14,154 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:14,191 - INFO - Image embeddings computed.
2025-04-18 17:39:14,372 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:14,381 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:14,419 - INFO - Image embeddings computed.
2025-04-18 17:39:14,600 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 17:39:14,609 - INFO - Computing image embeddings for the provided image...
2025-04-18 17:39:14,646 - INFO - Image embeddings computed.
2025-04-18 17:39:14,804 - INFO - Evaluation completed. Processed 17 samples successfully.
2025-04-18 17:39:14,805 - INFO - 
Model Comparison Results:
2025-04-18 17:39:14,805 - INFO - ================================================================================
2025-04-18 17:39:14,805 - INFO - Metric           Pre-trained   Fine-tuned  Improvement
2025-04-18 17:39:14,805 - INFO - --------------------------------------------------------------------------------
2025-04-18 17:39:14,805 - INFO - iou                   0.9612       0.1123       -88.3%
2025-04-18 17:39:14,806 - INFO - dice                  0.9802       0.2019       -79.4%
2025-04-18 17:39:14,806 - INFO - precision             0.9852       0.1123       -88.6%
2025-04-18 17:39:14,806 - INFO - recall                0.9754       1.0000         2.5%
2025-04-18 17:39:14,806 - INFO - 
Detailed results saved to: ./comparison_results/comparison_results.json
2025-04-18 17:39:14,806 - INFO - Log file: ./comparison_results/logs/comparison_20250418_173859.log
