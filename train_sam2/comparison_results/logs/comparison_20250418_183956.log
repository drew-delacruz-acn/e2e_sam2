2025-04-18 18:39:56,397 - INFO - Logging initialized. Log file: ./comparison_results/logs/comparison_20250418_183956.log
2025-04-18 18:39:56,397 - INFO - Python version: 3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:56:27) [GCC 11.2.0]
2025-04-18 18:39:56,397 - INFO - PyTorch version: 2.6.0+cu124
2025-04-18 18:39:56,397 - INFO - OpenCV version: 4.11.0
2025-04-18 18:39:56,397 - INFO - Arguments: {'data_dir': '../data/davis-2017/DAVIS/', 'splits_dir': './dataset_splits', 'pretrained_checkpoint': '../checkpoints/sam2.1_hiera_large.pt', 'finetuned_checkpoint': './model_best_val_0.9663.torch', 'model_cfg': '../configs/sam2.1/sam2.1_hiera_l.yaml', 'output_dir': './comparison_results', 'num_samples': -1, 'debug': False}
2025-04-18 18:39:56,440 - INFO - Using CUDA device: Tesla V100-SXM2-16GB
2025-04-18 18:39:56,440 - INFO - CUDA memory allocated: 0.00 GB
2025-04-18 18:39:56,440 - INFO - Loaded 17 samples from ./dataset_splits/val.json
2025-04-18 18:39:56,441 - INFO - 
Evaluating pre-trained model...
2025-04-18 18:39:56,441 - INFO - Loading model from ../checkpoints/sam2.1_hiera_large.pt
2025-04-18 18:39:56,441 - INFO - Loading as state dict: ../checkpoints/sam2.1_hiera_large.pt
2025-04-18 18:40:00,050 - INFO - Model loaded successfully
2025-04-18 18:40:00,079 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:00,191 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:00,524 - INFO - Image embeddings computed.
2025-04-18 18:40:00,714 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:00,752 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:00,789 - INFO - Image embeddings computed.
2025-04-18 18:40:00,970 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:00,979 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:01,016 - INFO - Image embeddings computed.
2025-04-18 18:40:01,197 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:01,206 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:01,243 - INFO - Image embeddings computed.
2025-04-18 18:40:01,424 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:01,434 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:01,471 - INFO - Image embeddings computed.
2025-04-18 18:40:01,652 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:01,661 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:01,698 - INFO - Image embeddings computed.
2025-04-18 18:40:01,879 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:01,890 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:01,927 - INFO - Image embeddings computed.
2025-04-18 18:40:02,108 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:02,120 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:02,157 - INFO - Image embeddings computed.
2025-04-18 18:40:02,340 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:02,357 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:02,394 - INFO - Image embeddings computed.
2025-04-18 18:40:02,576 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:02,585 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:02,622 - INFO - Image embeddings computed.
2025-04-18 18:40:02,802 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:02,812 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:02,849 - INFO - Image embeddings computed.
2025-04-18 18:40:03,030 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:03,039 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:03,076 - INFO - Image embeddings computed.
2025-04-18 18:40:03,260 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:03,277 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:03,314 - INFO - Image embeddings computed.
2025-04-18 18:40:03,495 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:03,504 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:03,541 - INFO - Image embeddings computed.
2025-04-18 18:40:03,722 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:03,731 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:03,768 - INFO - Image embeddings computed.
2025-04-18 18:40:03,948 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:03,954 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:03,991 - INFO - Image embeddings computed.
2025-04-18 18:40:04,172 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:04,181 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:04,218 - INFO - Image embeddings computed.
2025-04-18 18:40:04,376 - INFO - Evaluation completed. Processed 17 samples successfully.
2025-04-18 18:40:04,379 - INFO - 
Evaluating fine-tuned model...
2025-04-18 18:40:04,379 - INFO - Loading model from ./model_best_val_0.9663.torch
2025-04-18 18:40:04,379 - INFO - Loading as state dict: ./model_best_val_0.9663.torch
2025-04-18 18:40:07,562 - INFO - Model loaded successfully
2025-04-18 18:40:07,588 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:07,597 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:07,635 - INFO - Image embeddings computed.
2025-04-18 18:40:07,841 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:07,850 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:07,888 - INFO - Image embeddings computed.
2025-04-18 18:40:08,074 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:08,083 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:08,120 - INFO - Image embeddings computed.
2025-04-18 18:40:08,301 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:08,307 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:08,343 - INFO - Image embeddings computed.
2025-04-18 18:40:08,525 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:08,534 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:08,570 - INFO - Image embeddings computed.
2025-04-18 18:40:08,751 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:08,760 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:08,796 - INFO - Image embeddings computed.
2025-04-18 18:40:08,977 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:08,986 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:09,022 - INFO - Image embeddings computed.
2025-04-18 18:40:09,204 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:09,213 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:09,248 - INFO - Image embeddings computed.
2025-04-18 18:40:09,430 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:09,439 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:09,475 - INFO - Image embeddings computed.
2025-04-18 18:40:09,657 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:09,666 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:09,701 - INFO - Image embeddings computed.
2025-04-18 18:40:09,883 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:09,892 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:09,928 - INFO - Image embeddings computed.
2025-04-18 18:40:10,110 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:10,120 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:10,155 - INFO - Image embeddings computed.
2025-04-18 18:40:10,338 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:10,347 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:10,382 - INFO - Image embeddings computed.
2025-04-18 18:40:10,564 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:10,574 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:10,609 - INFO - Image embeddings computed.
2025-04-18 18:40:10,791 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:10,800 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:10,835 - INFO - Image embeddings computed.
2025-04-18 18:40:11,017 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:11,027 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:11,062 - INFO - Image embeddings computed.
2025-04-18 18:40:11,244 - INFO - For numpy array image, we assume (HxWxC) format
2025-04-18 18:40:11,253 - INFO - Computing image embeddings for the provided image...
2025-04-18 18:40:11,288 - INFO - Image embeddings computed.
2025-04-18 18:40:11,447 - INFO - Evaluation completed. Processed 17 samples successfully.
2025-04-18 18:40:11,448 - INFO - 
Model Comparison Results:
2025-04-18 18:40:11,449 - INFO - ================================================================================
2025-04-18 18:40:11,449 - INFO - Metric           Pre-trained   Fine-tuned  Improvement
2025-04-18 18:40:11,449 - INFO - --------------------------------------------------------------------------------
2025-04-18 18:40:11,449 - INFO - iou                   0.9069       0.1141       -87.4%
2025-04-18 18:40:11,449 - INFO - dice                  0.9263       0.2049       -77.9%
2025-04-18 18:40:11,449 - INFO - precision             0.9813       0.1141       -88.4%
2025-04-18 18:40:11,449 - INFO - recall                0.9216       1.0000         8.5%
2025-04-18 18:40:11,449 - INFO - 
Detailed results saved to: ./comparison_results/comparison_results.json
2025-04-18 18:40:11,449 - INFO - Log file: ./comparison_results/logs/comparison_20250418_183956.log
